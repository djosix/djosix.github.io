(function(e){function t(t){for(var s,n,a=t[0],i=t[1],r=t[2],h=0,p=[];h<a.length;h++)n=a[h],Object.prototype.hasOwnProperty.call(l,n)&&l[n]&&p.push(l[n][0]),l[n]=0;for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s]);d&&d(t);while(p.length)p.shift()();return c.push.apply(c,r||[]),o()}function o(){for(var e,t=0;t<c.length;t++){for(var o=c[t],s=!0,a=1;a<o.length;a++){var i=o[a];0!==l[i]&&(s=!1)}s&&(c.splice(t--,1),e=n(n.s=o[0]))}return e}var s={},l={app:0},c=[];function n(t){if(s[t])return s[t].exports;var o=s[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=s,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(o,s,function(t){return e[t]}.bind(null,s));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],i=a.push.bind(a);a.push=t,a=a.slice();for(var r=0;r<a.length;r++)t(a[r]);var d=i;c.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"56d7":function(e,t,o){"use strict";o.r(t);var s=o("7a23");const l={class:"container"},c={key:0,class:"chord-row"},n={key:1};function a(e,t,o,a,i,r){const d=Object(s["l"])("ChordBlock");return Object(s["h"])(),Object(s["d"])("div",l,[i.samplesAreLoaded?(Object(s["h"])(),Object(s["d"])("div",c,[Object(s["f"])(d,{onPlayChordNotes:r.playChordNotes},null,8,["onPlayChordNotes"]),Object(s["f"])(d,{onPlayChordNotes:r.playChordNotes},null,8,["onPlayChordNotes"]),Object(s["f"])(d,{onPlayChordNotes:r.playChordNotes},null,8,["onPlayChordNotes"]),Object(s["f"])(d,{onPlayChordNotes:r.playChordNotes},null,8,["onPlayChordNotes"]),Object(s["f"])(d,{onPlayChordNotes:r.playChordNotes},null,8,["onPlayChordNotes"]),Object(s["f"])(d,{onPlayChordNotes:r.playChordNotes},null,8,["onPlayChordNotes"]),Object(s["f"])(d,{onPlayChordNotes:r.playChordNotes},null,8,["onPlayChordNotes"]),Object(s["f"])(d,{onPlayChordNotes:r.playChordNotes},null,8,["onPlayChordNotes"])])):(Object(s["h"])(),Object(s["d"])("div",n,"loading samples..."))])}const i=e=>(Object(s["j"])("data-v-3429dc7a"),e=e(),Object(s["i"])(),e),r={class:"chord-block"},d={class:"chord-comment"},h=i(()=>Object(s["e"])("hr",null,null,-1)),p=i(()=>Object(s["e"])("th",{class:"field-label"},"chord",-1)),u={class:"field-input"},b=["list","placeholder"],m=["id"],f=["value"],y=i(()=>Object(s["e"])("th",{class:"field-label"},"comment",-1)),N={class:"field-input"},O=i(()=>Object(s["e"])("td",null,null,-1)),j={class:"buttons"},C=i(()=>Object(s["e"])("div",{class:"space"},null,-1)),v=i(()=>Object(s["e"])("div",{class:"space"},null,-1));function g(e,t,o,l,c,n){const a=Object(s["l"])("PianoKeys");return Object(s["h"])(),Object(s["d"])("div",r,[Object(s["e"])("h2",{class:"chord-title",onClick:t[0]||(t[0]=(...e)=>n.playChordNotes&&n.playChordNotes(...e))},Object(s["m"])(c.title||"-"),1),Object(s["e"])("div",d,Object(s["m"])(c.comment||c.name||"-"),1),h,Object(s["e"])("table",null,[Object(s["e"])("tr",null,[p,Object(s["e"])("td",u,[Object(s["o"])(Object(s["e"])("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>c.symbol=e),list:e.datalistId,placeholder:c.chordOptions,onclick:"this.select()",onchange:"this.blur()"},null,8,b),[[s["n"],c.symbol]]),Object(s["e"])("datalist",{id:e.datalistId},[(Object(s["h"])(!0),Object(s["d"])(s["a"],null,Object(s["k"])(c.chordOptions,o=>(Object(s["h"])(),Object(s["d"])("option",{value:o,onClick:t[2]||(t[2]=(...t)=>e.alert&&e.alert(...t))},Object(s["m"])(o),9,f))),256))],8,m)])]),Object(s["e"])("tr",null,[y,Object(s["e"])("td",N,[Object(s["o"])(Object(s["e"])("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>c.comment=e)},null,512),[[s["n"],c.comment]])])]),Object(s["e"])("tr",null,[O,Object(s["e"])("td",j,[Object(s["e"])("button",{type:"button",onClick:t[4]||(t[4]=(...e)=>n.clearSelectedNotes&&n.clearSelectedNotes(...e))},"clear"),C,Object(s["e"])("button",{type:"button",onClick:t[5]||(t[5]=(...e)=>n.fillChordNotes&&n.fillChordNotes(...e))},"fill"),v,Object(s["e"])("button",{type:"button",onClick:t[6]||(t[6]=(...e)=>n.playChordNotes&&n.playChordNotes(...e))},"play")])])]),Object(s["f"])(a,{onUpdateSelectedNotes:n.onUpdateSelectedNotes,ref:"pianoKeys"},null,8,["onUpdateSelectedNotes"])])}var k=o("11c1");const S={class:"piano"},w={class:"key-container"},P=["onClick"],K={key:0,class:"label"};function _(e,t,o,l,c,n){return Object(s["h"])(),Object(s["d"])("div",S,[Object(s["e"])("div",w,[(Object(s["h"])(!0),Object(s["d"])(s["a"],null,Object(s["k"])(e.notes,e=>(Object(s["h"])(),Object(s["d"])("div",{class:Object(s["g"])(["key",n.getKeyClassByNote(e)]),onClick:t=>n.toggleSelectedNote(e)},[e.alt?Object(s["c"])("",!0):(Object(s["h"])(),Object(s["d"])("div",K,Object(s["m"])("C"==e.pc?e.name:e.pc),1))],10,P))),256))])])}var M=o("772f"),U={name:"PianoKeys",created(){const e=M["Note"].midi("C2"),t=49;this.notes=[...Array(t).keys()].map(t=>e+t).map(M["Note"].fromMidi).map(M["Note"].get).reverse()},data(){return{chordNotes:new Set,tonicNotes:new Set,selectedNotes:new Set,selectedChromas:new Set}},methods:{toggleSelectedNote(e){const t=this.selectedNotes.has(e.midi);this.updateSelectedNotes([e],!t)},updateSelectedNotes(e,t=!0){e.forEach(e=>{t?this.selectedNotes.add(e.midi):this.selectedNotes.delete(e.midi)}),this.selectedChromas.clear(),this.selectedNotes.forEach(e=>this.selectedChromas.add(M["Note"].get(M["Note"].fromMidi(e)).chroma)),console.log(this.selectedNotes),this.$emit("updateSelectedNotes",[...this.selectedNotes].map(M["Note"].fromMidi).map(M["Note"].get))},clearSelectedNotes(){this.selectedNotes.clear(),this.selectedChromas.clear(),this.$emit("updateSelectedNotes",[...this.selectedNotes])},getKeyClassByNote(e){let t={white:!e.alt,black:e.alt,chord:this.chordNotes.has(e.midi),tonic:this.tonicNotes.has(e.midi),selected:this.selectedNotes.has(e.midi),presented:this.selectedChromas.has(e.chroma)};return t["key-"+e.name]=!0,t["key-"+e.pc]=!0,t},highlightChord(e){if(this.chordNotes.clear(),this.tonicNotes.clear(),e){let t=new Set(e.notes.map(M["Note"].chroma)),o=M["Note"].chroma(e.tonic);this.notes.forEach(e=>{t.has(e.chroma)&&this.chordNotes.add(e.midi),o==e.chroma&&this.tonicNotes.add(e.midi)})}}}},$=(o("f37a"),o("6b0d")),x=o.n($);const A=x()(U,[["render",_],["__scopeId","data-v-53bbf98c"]]);var B=A;M["Chord"];var I={name:"ChordBlock",beforeCreate(){this.datalistId=Object(k["v4"])()},data(){return{title:"-",name:"-",comment:"",symbol:"",chord:null,notes:new Set,chordOptions:[]}},methods:{onUpdateSelectedNotes(e){this.notes=e,this.chordOptions=M["Chord"].detect(this.notes),this.highlightChord(),this.playChordNotes()},highlightChord(){let e=null;this.chord?e=this.chord:this.notes.length&&(e={notes:[...new Set(this.notes.map(e=>e.pc))],tonic:M["Note"].get(M["Note"].fromMidi(Math.min(...this.notes.map(M["Note"].midi)))).pc}),this.$refs.pianoKeys.highlightChord(e)},clearSelectedNotes(){this.$refs.pianoKeys.clearSelectedNotes()},playChordNotes(){this.$emit("playChordNotes",this.notes)},fillChordNotes(){if(this.chord){this.$refs.pianoKeys.clearSelectedNotes();let e=[this.chord.tonic+"3",...this.chord.notes.map(e=>e+"4")];this.$refs.pianoKeys.updateSelectedNotes(e.map(M["Note"].get),!0)}}},watch:{symbol(e){if(""==e)this.chord=null,this.title="",this.name="";else{let e=M["Chord"].get(this.symbol);this.chord=e.empty?null:e,this.title=this.chord?this.chord.symbol:this.symbol||"?",this.name=this.chord?this.chord.name:"(unknown chord)"}this.highlightChord()}},components:{PianoKeys:B}};o("66e8");const E=x()(I,[["render",g],["__scopeId","data-v-3429dc7a"]]);var T=E,L=o("5e54"),D=o("af81");window.Tonal=M,window.Tone=L;var J={name:"App",created(){this.piano=new D["a"]({velocities:5}),this.piano.toDestination(),this.piano.load().then(()=>{this.samplesAreLoaded=!0,console.log("loaded!")})},data(){return{samplesAreLoaded:!1}},methods:{playChordNotes(e){e.length&&e.forEach(e=>{this.piano.keyDown({note:e.name,velocity:.2}),this.piano.keyUp({note:e.name,time:"+2"})})}},components:{ChordBlock:T}};o("633f");const V=x()(J,[["render",a]]);var q=V;Object(s["b"])(q).mount("#app")},"5e90":function(e,t,o){},"633f":function(e,t,o){"use strict";o("a66f")},"66e8":function(e,t,o){"use strict";o("b3b3")},a66f:function(e,t,o){},b3b3:function(e,t,o){},f37a:function(e,t,o){"use strict";o("5e90")}});
//# sourceMappingURL=app.88e08d88.js.map